---
title: "Final project"
author: "Yuval Gedulter"
date: "2025-03-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


עבודה מסכמת – קורס היכרות עם R
שלב א' – הגדרת שאלת המחקר:
1.	בחרתי לנתח את הדאטאסט שאספתי מניסוי שערכתי במסגרת עבודת המחקר שלי. המחקר שלי עוסק באינטראקציה בין צמחים הלופיטים (אוהבי מלח) לפתוגנים (מחוללי מחלה) תחת עקת מלח, תחום שמסקרן אותי מאוד בשל השפעתו על החקלאות העולמית. קרקעות מומלחות מהוות אתגר גלובלי לכל ענף החקלאות ולסוגיית הביטחון התזונתי, והתחזיות מצביעות על כך שבשנת 2050 לפחות חצי מהקרקע החקלאית בעולם תסבול מזיהום מלח(Jamil et al., 2011) . הנושא חשוב גם מבחינה אקולוגית וגם מבחינה חקלאית, וההלופיטים מעניקים לי הזדמנות לחקור את הפוטנציאל שלהם להתמודדות ישירה עם הבעיה, למטרת טיהור יעיל של קרקעות מומלחות.
בניסוי זה גידלתי את ההלופיט אשליל שעיר(Reaumuria hirtella) , הידוע כמפריש עודפי מלח דרך העלים (Waisel & Agami, 1979), תחת שמונה טיפולים שונים: טיפול בכמות מלח נורמלית למול טיפול בכמות מלח גבוהה בקרקע, טיפול בתוסף סיליקון למול טיפול ללא סיליקון (מינרל שידוע כמקל עקות בצמחים), וטיפול שמדמה עקה פתוגנית (באמצעות חומצה פיפקולית) למול טיפול ללא העקה. כלומר טיפול תלת-פקטוריאלי 2×2×2. בסיום הניסוי מדדתי עיכוב התפתחותי על ידי גובה הצמח, מספר פיצולים, שטח פנים ומשקל; כמו כן, מדדתי את המוליכות החשמלית של התמיסה שהופרשה מהצמח (מדידות נוספות של כמויות המלח והסיליקון בצמח ובהפרשותיו טרם בוצעו).

3.  Research question:
Does salt uptake by halophytes increase in response to pathogenic stress?
שלב ב' – עיבוד מקדים של הנתונים:
1.	משתנים מנבאים:
•	“Treatment” – הטיפול שנעשה בצמחים מנבא, ולמעשה מתווך, את השינויים הפנוטיפיים בצמחים, כלומר כמות המלח המופרש מהעלים ופרמטרים של התפתחות הצמח (גובה, מספר פיצולים וביומסה).
•	“Population” – כל אוכלוסייה ממנה נאספו הזרעים מגיעה עם פרופיל גנטי ואפי-גנטי שונה, ולכן הגרפים מראים שינוי בין אוכלוסיות שונות.
•	“Height” – גובה הצמח.
•	“Biomass” – המשקל של הצמח היבש.
משתנים מנובאים:
•	“Secretion_EC”/”Normal_EC” – המוליכות החשמלית של נוזל ההפרשה שנאסף מהצמח, לא מנורמל/ מנורמל לפי שטח הפנים שלו.
בגרפים של הצגת הנתונים המקדימה שיצרתי, ניתן היה להבחין כי קיים הבדל נראה לעין בין קבוצות הטיפול השונות ובין האוכלוסיות השונות, בכמות המלח המופרש. יחד עם זאת, חשוב לציין כי גודל הצמח הוא קו-פקטור חשוב שיש לנטרל בכדי להעריך את יעילות הטיפולים בספיחה מוגברת של מלח. בכדי לענות על השאלה שהצגתי, שהיא השאלה המעניינת ובעלת החשיבות הביולוגית, הסביבתית והיישומית, ניתן לפצות על פערי גודל הצמח על ידי נרמול של כמות המלחים המופרשת ליחידת מידה מסוימת, למשל לגרם/ לסנטימטר רבוע. כאשר המודל מנטרל את משתנה הגודל, אשתמש בנתונים שאינם מנורמלים ידנית (Secretion_EC), וכאשר לא יהיה ניתן להשתמש בנתוני ההפרשה הגולמית, אשתמש בנתונים המנורמלים לפי שטח פנים (Normal_EC).
שלב ג' – ניתוח הנתונים:
2.	תוצאות הרגרסיה הלינארית המרובה:

Call:
lm(formula = Secretion_EC ~ Treatment_factor + Biomass + Height, 
    data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1221.22  -175.84   -19.91   105.40  1539.72 

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  -214.167    112.347  -1.906  0.05866 .  
Treatment_factorPip            64.393    112.592   0.572  0.56829    
Treatment_factorSi             -8.222    112.341  -0.073  0.94176    
Treatment_factorPip+Si         77.214    113.820   0.678  0.49865    
Treatment_factorNaCl          330.801    116.310   2.844  0.00512 ** 
Treatment_factorNaCl+Pip      529.126    119.410   4.431 1.88e-05 ***
Treatment_factorNaCl+Si       379.268    120.785   3.140  0.00206 ** 
Treatment_factorNaCl+Pip+Si   269.293    119.675   2.250  0.02600 *  
Biomass                     11737.587   1416.399   8.287 8.51e-14 ***
Height                         23.970     20.563   1.166  0.24573    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 354.5 on 140 degrees of freedom
  (10 observations deleted due to missingness)
Multiple R-squared:  0.5621,	Adjusted R-squared:  0.5339 
F-statistic: 19.96 on 9 and 140 DF,  p-value: < 2.2e-16


מבחינת הטיפול שניתן, תוצאות המודל מראות כי ריכוז ה-NaCl בקרקע הוא המרכיב המשמעותי ביותר שמשפיע על המוליכות החשמלית של נוזל ההפרשה בצמח. ניתן להבחין בכך לפי ערך ה-p-value שחושב בהשוואה ל-intercept, כלומר, טיפול הביקורת. טיפול זה בעצמו מקבל ערך שלילי כאשר כל שאר המשתנים מנוטרלים. אין לזה משמעות ביולוגית כיוון שאין מוליכות שלילית ואין צמח ללא ביומסה, אבל הוא משמש מספר סטטיסטי כנקודת ייחוס למודל. בנוסף, ניתן להבחין שערך ה-estimate כמעט ולא השתנה בטיפולים שבהם ריכוז המלח בקרקע נמוך.
בנוסף, תחת תנאי מליחות גבוהים, ניתן לראות שטיפול בחומצה פיפקולית מעלה יותר את המוליכות של הנוזל המופרש (p-value = 1.88e-05). לעומת זאת, תוסף הסיליקון משפיע פחות מהחומצה אך מעט יותר מהמלח לבדו עם estimate = 379.268.
משקל הצמח משפיע באופן המשמעותי ביותר על המוליכות החשמלית של הנוזל המופרש, עם p-value = 8.51e-14. המשמעות הביולוגית היא שאין “trade-off” בין גודל הצמח לכמות המלחים שהוא מסוגל להפריש, כלומר צמח קטן יפריש פחות מלח, בכל מקרה וללא תנאי בסוג הטיפול. מבחינת ניבוי המודל, עלייה של כל יחידת ביומסה (גרם), תתבטא בעלייה של 11737.587 ביחידות EC (µS/cm). הדבר נובע כנראה מירידה בריכוז המלח בצמח ככל שהוא גדל, ולכן פוטנציאל הספיחה עולה ככל שהעקה האוסמוטית מריכוזים גבוהים פוחתת.
מבחינת אמינות המודל,56.21%  מהשונות ב-EC של הנוזל המופרש מוסברת באמצעות המודל. מובהקות המודל גם כן גבוהה מאוד עם p-value < 2.2e-16. מודל זה הציג את ההסבר הטוב ביותר לשונות שנמצאה בהשוואה למודלים נוספים ששיקללו קו-פקטורים/ משתנים רנדומליים נוספים.

תוצאות הרגרסיה הלוגיסטית:
Call:
glm(formula = Normal_EC_binary ~ Treatment_factor + Biomass + 
    Height, family = binomial, data = data)

Coefficients:
                             Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   -5.3669     1.5911  -3.373 0.000743 ***
Treatment_factorPip            1.0839     1.4092   0.769 0.441823    
Treatment_factorSi           -15.2078  1299.5596  -0.012 0.990663    
Treatment_factorPip+Si         1.7108     1.4616   1.171 0.241788    
Treatment_factorNaCl           4.6390     1.4324   3.239 0.001201 ** 
Treatment_factorNaCl+Pip       5.4904     1.4935   3.676 0.000237 ***
Treatment_factorNaCl+Si        4.2813     1.4923   2.869 0.004119 ** 
Treatment_factorNaCl+Pip+Si    4.6852     1.4898   3.145 0.001662 ** 
Biomass                       39.8135    15.4365   2.579 0.009903 ** 
Height                        -0.0523     0.1895  -0.276 0.782571    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 180.84  on 148  degrees of freedom
Residual deviance: 111.36  on 139  degrees of freedom
  (11 observations deleted due to missingness)
AIC: 131.36

Number of Fisher Scoring iterations: 17

לצורך חיזוק התוצאה והבנה מעמיקה יותר של ההשלכות שעשויות להיות לה, חילקתי את הצמחים לשתי קבוצות לפי הערך המנורמל של כמות המלח שהופרש, בהתאם לערך הביולוגי שממנו קרקע מוגדרת כמלוחה עבור צמחים. מכיוון שהלופיטים מותאמים לסביבות מלוחות, ערך זה הוכפל פי 1.5, כלומר 6000µS/cm. המשמעות הפוטנציאלית היא שגם ריכוז מאוד גבוה של מלח בקרקע, שבה אף גידול חקלאי לא יכול לשרוד, יכול להתנקז בצמח זה.
תוצאות מודל הרגרסיה הלוגיסטית שהרצתי מצביעות על מגמה דומה לתוצאות הרגרסיה הלינארית. באינטרספט, הלוגריתם של יחס הסיכויים שלילי מאוד (estimate = -5.3669), כלומר הסיכוי לקבל הפרשה גבוהה של מלחים נמוך מאוד, כמצופה. מבחינת פקטורי הטיפול, בריכוז נמוך של NaCl בקרקע הסיכויים לקבל צמח שמפריש כמות גבוהה של מלח מאוד נמוכים ובהתאם גם לא מובהקים סטטיסטית, גם בשילוב עם סיליקון* ו/או חומצה פיפקולית. לעומת זאת, כאשר ריכוז המלח בקרקע גבוה, הסיכוי שצמח יפריש כמות גבוהה מאוד של מלח הוא גבוה ומובהק מאוד סטטיסטית. התוצאה האופטימלית ביותר מתקבלת תחת טיפול בחומצה פיפקולית כאשר הקרקע מזוהמת במלח, עם estimate = 5.4904, מובהק מאוד סטטיסטית (p-value = 0.000237). נראה כי תוסף הסיליקון אכן מקל במידה קלה על עקת המלח, כך שבלעדיו הסיכוי לצמח שמפריש כמות גבוהה לפי ההגדרה, מעט יותר גבוה, כפי שניתן לראות ב-estimate.
* התוצאה שהתקבלה מאוד חריגה, estimate = -15.2078, וזה בא לידי ביטוי גם בשגיאת תקן לא סבירה.
גם במודל זה ניתן לראות את השפעת המשקל הרבה מאוד (estimate = 39.8135), על אף שכאן השתמשתי ב-EC המנורמל לפי שטח פנים. הדבר מצביע כנראה על מתאם שאינו מלא בין הביומסה לשטח הפנים של הצמח. במודל זה, בדומה למודל הלינארי, לגובה אין השפעה ממשית.
המודל מסביר את הנתונים באופן טוב, יחסית: AIC = 131.36.

References:
Jamil, A., Riaz, S., Ashraf, M., & Foolad, M. R. (2011). Gene Expression Profiling of Plants under Salt Stress. Critical Reviews in Plant Sciences, 30(5), 435–458. https://doi.org/10.1080/07352689.2011.605739
Waisel, Y., & Agami, M. (1979). Halophytes of Israel.

